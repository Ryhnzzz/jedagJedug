<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Jedag Jedug Fireworks Disco Sync</title>
  <style>
    body{
      margin:0;
      height:100vh;
      display:flex;
      align-items:center;
      justify-content:center;
      background:#000;
      overflow:hidden;
    }
    .slideshow{
      position:relative;
      width:100%;
      height:100%;
      overflow:hidden;
      transition:filter 0.1s linear, opacity 0.5s ease;
      opacity:0; /* disembunyikan awal */
    }
    .slideshow.ready {
      opacity:1; /* tampil ketika audio siap */
    }
    .slide{
      position:absolute;
      width:100%;
      height:100%;
      object-fit:cover;
      opacity:0;
      animation: fadeScale 9s infinite;
    }
    .slide:nth-child(1){animation-delay:0s}
    .slide:nth-child(2){animation-delay:3s}
    .slide:nth-child(3){animation-delay:6s}
    .slide:nth-child(4){animation-delay:9s}
    .slide:nth-child(5){animation-delay:12s}
    .slide:nth-child(6){animation-delay:15s}
    .slide:nth-child(7){animation-delay:18s}
    .slide:nth-child(8){animation-delay:21s}
    .slide:nth-child(9){animation-delay:24s}

    @keyframes fadeScale{
      0%{opacity:0;transform:scale(1)}
      5%{opacity:1;transform:scale(1.05)}
      20%{opacity:1;transform:scale(1.15)}
      25%{opacity:0;transform:scale(1.2)}
      100%{opacity:0}
    }

    /* Jedag Jedug */
    .beat{
      animation:beatBrutal 0.35s linear;
    }
    @keyframes beatBrutal{
      0%{transform:scale(1) translate(0,0)}
      20%{transform:scale(1.5) translate(-15px,5px) rotate(-6deg)}
      40%{transform:scale(0.85) translate(15px,-5px) rotate(6deg)}
      60%{transform:scale(1.6) translate(-10px,10px) rotate(-8deg)}
      80%{transform:scale(0.9) translate(10px,-10px) rotate(8deg)}
      100%{transform:scale(1) translate(0,0) rotate(0)}
    }

    .disco, .spotlight, .rocket, .particle{
      pointer-events:none;
      position:absolute;
    }
    .disco{
      inset:0;
      mix-blend-mode:screen;
      background:radial-gradient(circle at 20% 30%, rgba(255,0,255,0.7), transparent 40%),
                 radial-gradient(circle at 80% 70%, rgba(0,255,255,0.7), transparent 40%),
                 radial-gradient(circle at 50% 50%, rgba(255,255,0,0.7), transparent 40%);
      opacity:0.4;
      transition:opacity 0.1s ease, filter 0.1s ease;
    }
    .spotlight{
      inset:0;
      background:radial-gradient(circle at center, rgba(255,255,255,0.6), transparent 70%);
      mix-blend-mode:overlay;
      opacity:0.2;
      transition:opacity 0.1s ease;
    }
    .rocket{
      width:4px;
      height:14px;
      background:white;
      border-radius:2px;
      animation:shoot 0.5s forwards;
    }
    @keyframes shoot{
      from{transform:translateY(0);opacity:1}
      to{transform:translateY(-250px);opacity:0.8}
    }
    .particle{
      width:6px;
      height:6px;
      border-radius:50%;
      animation:explode 1.2s forwards;
    }
    @keyframes explode{
      from{transform:translate(0,0) scale(1);opacity:1}
      to{transform:translate(var(--x), var(--y)) scale(0.3);opacity:0}
    }
  </style>
</head>
<body>
  <div class="slideshow" id="slideshow">
    <img class="slide" src="gambar1.jpg" alt="Teman 1"> 
    <img class="slide" src="gambar2.jpg" alt="Teman 2"> 
    <img class="slide" src="gambar3.jpg" alt="Teman 3"> 
    <img class="slide" src="gambar4.jpg" alt="Teman 4"> 
    <img class="slide" src="gambar5.jpg" alt="Teman 5"> 
    <img class="slide" src="gambar7.jpg" alt="Teman 7"> 
    <img class="slide" src="gambar8.jpg" alt="Teman 8"> 
    <img class="slide" src="gambar6.jpg" alt="Teman 6"> 
    <img class="slide" src="gambar9.jpg" alt="Teman 9"> 

    <div class="disco" id="disco"></div>
    <div class="spotlight" id="spotlight"></div>
  </div>

  <audio id="bgm" loop crossorigin="anonymous">
    <source src="lagu1.mp3" type="audio/mpeg">
  </audio>

  <script>
    const audio = document.getElementById('bgm');
    const slideshow = document.getElementById('slideshow');
    const disco = document.getElementById('disco');
    const spotlight = document.getElementById('spotlight');

    // tunggu audio siap
    audio.addEventListener('canplaythrough', () => {
      slideshow.classList.add('ready'); // tampilkan slideshow
      audio.play().catch(()=>{}); // autoplay fix untuk browser
    });

    document.addEventListener('click', ()=>{if(audio.paused){ audio.play(); slideshow.classList.add('ready'); }},{once:true});

    // Web Audio API
    const ctx = new (window.AudioContext||window.webkitAudioContext)();
    const src = ctx.createMediaElementSource(audio);
    const analyser = ctx.createAnalyser();
    src.connect(analyser);
    analyser.connect(ctx.destination);
    analyser.fftSize = 256;
    const dataArray = new Uint8Array(analyser.frequencyBinCount);

    function animate(){
      requestAnimationFrame(animate);
      analyser.getByteFrequencyData(dataArray);
      let mid = dataArray.slice(20, 60).reduce((a,b)=>a+b,0)/40;
      slideshow.style.filter = `brightness(${0.6 + mid/200})`;
      disco.style.opacity = mid > 150 ? 1 : 0.3;
      disco.style.filter = `hue-rotate(${mid*4}deg)`;
      spotlight.style.opacity = mid/250;
      if(mid > 160){ triggerBeat(); spawnRocket(); }
    }
    animate();

    function triggerBeat(){
      slideshow.classList.remove("beat");
      void slideshow.offsetWidth;
      slideshow.classList.add("beat");
    }

    function spawnRocket(){
      const rocket=document.createElement("div");
      rocket.className="rocket";
      rocket.style.left=Math.random()*window.innerWidth+"px";
      rocket.style.top=window.innerHeight+"px";
      document.body.appendChild(rocket);
      setTimeout(()=>{
        rocket.remove();
        for(let i=0;i<40;i++){
          const p=document.createElement("div");
          p.className="particle";
          p.style.left=rocket.style.left;
          p.style.top=(window.innerHeight-250)+"px";
          p.style.background=`hsl(${Math.random()*360},100%,50%)`;
          p.style.setProperty("--x", (Math.random()*600-300)+"px");
          p.style.setProperty("--y", (Math.random()*600-300)+"px");
          document.body.appendChild(p);
          setTimeout(()=>p.remove(),1200);
        }
      },500);
    }
  </script>
</body>
</html>





